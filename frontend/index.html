<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Webpage Element Classifier</title>
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet" crossorigin="anonymous">
</head>
<body>
  <div class="container h-100 py-2">
    <nav class="navbar bg-body-tertiary mb-4">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" width="30" height="24" class="d-inline-block align-text-top me-3">
          Webpage Element Classifier
        </a>
      </div>
    </nav>

    <div id="carouselExampleDark" class="carousel slide mb-4" data-bs-theme="light">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2" aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active" data-bs-interval="10000">
          <img src="{{ url_for('static', filename='img-1.jpg') }}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5 class="text-white"><strong>Web Based Element Classifier</strong></h5>
            <p class="text-white">Upload and image to detect html elements.</p>
          </div>
        </div>
        <div class="carousel-item" data-bs-interval="2000">
          <img src="{{ url_for('static', filename='img-2.jpg') }}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5 class="text-white"><strong>Web Based Element Classifier</strong></h5>
            <p class="text-white">Using YOLOv8 to detect web page elements from screenshots.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="{{ url_for('static', filename='img-3.jpg') }}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5 class="text-white"><strong>Web Based Element Classifier</strong></h5>
            <p class="text-white">Upload and image to detect html elements.</p>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    
    <div class="card mb-4">
      <div class="card-body mb-4">
        <h5 class="card-title">About</h5>
        <h6 class="card-subtitle mb-2 text-body-secondary">What is this project about?</h6>
        <p class="card-text">
          Our trained model using YOLOv8 detects HTML elements in an image.
          By simply uploading a screenshot of your web application, you can run this model and
          it will detect all the elements present in the webpage and give you the results below.
          Try it out below!
        </p>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Upload a Screenshot</h5>
        <form id="upload-form">
          <input type="file" id="image-input" class="form-control" name="image" accept="image/*" required>
          <button type="submit" class="btn btn-dark mt-2 mb-4 float-end">Process</button>
        </form>
      </div>
    </div>

    <div id="result-card" class="card mb-4" style="display: none;">
      <div class="row">
        <div class="col">
          <img id="input-image" class="rounded" style="max-width: 100%;" alt="Original Image">
        </div>
        <div class="col">
          <img id="output-image" class="rounded" style="max-width: 100%;" alt="Processed Image">
        </div>
      </div>
      <div class="card-body">
        <h5 class="card-title">Results</h5>
        <h6 class="card-subtitle mb-2 text-body-secondary">We can see the result of our model in the above image</h6>
        <p class="card-text">Based on the screenshot, the model has detected the HTML elements present in it.</p>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->
  <script>
    const myCarouselElement = document.querySelector('#carouselExampleDark')

    const carousel = new bootstrap.Carousel(myCarouselElement, {
      interval: 2000,
      touch: false
    })

    const form = document.getElementById("upload-form");
    const outputImage = document.getElementById("output-image");
    const inputImage = document.getElementById("input-image");
    const resultCard = document.getElementById("result-card");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData();
      const fileInput = document.getElementById("image-input");
      formData.append("image", fileInput.files[0]);

      try {
        const response = await fetch("http://127.0.0.1:5000/predict", {
          method: "POST",
          body: formData,
        });

        if (response.ok) {
          const blob = await response.blob();
          outputImage.src = URL.createObjectURL(blob);
          inputImage.src = URL.createObjectURL(fileInput.files[0]);
          resultCard.style.display = "block";
          resultCard.scrollIntoView({ behavior: "smooth", block: "start", inline: "end" });
        } else {
          console.error("Error:", await response.json());
        }
      } catch (error) {
        console.error("Error:", error);
      }
    });
  </script>
</body>
</html>